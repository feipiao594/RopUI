# 跨平台调度器开发

这个阶段的任务主要是实现各个平台的 eventloop_core 用来提供不同平台的监听事件

目前 Linux 平台已经完整支持

Windows/MacOS 平台需要测试

严重警告：windows 平台的 api 依赖一个不可以重复的 key 值，需要在后期加入一个全局 key 池来避免 key 碰撞，非常注意，wakeup 目前硬编码了这个 key 值，后期一定一定要改

注意 watcher 的设计，就是被回掉捕获的 watcher 持有的资源需要 shared_ptr 包一层，因为能不捕获 this 就不捕获（优先 State 或把资源/逻辑放进 source）。例子如 wakeupWatcher 系列
只有当确实没办法要捕获 this 时，才用 weak_ptr 兜底（并把 watcher 做成 shared_ptr 生命周期）。例子如 example/linux_loop_core_test


macos:
```objectivec
NSEvent* ev = [NSEvent otherEventWithType:NSEventTypeApplicationDefined
                                 location:NSZeroPoint
                            modifierFlags:0
                                timestamp:0
                             windowNumber:0
                                  context:nil
                                  subtype:0
                                    data1:0
                                    data2:0];
```

这边我们规定了 wakeup 自定义事件的 subtype 是 0